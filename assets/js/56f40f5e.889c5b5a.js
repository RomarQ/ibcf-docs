(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[921],{38996:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{_:()=>runCode});var typescript__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(55423),typescript__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(typescript__WEBPACK_IMPORTED_MODULE_0__),ibcf_sdk__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(69754),ibcf_sdk__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(ibcf_sdk__WEBPACK_IMPORTED_MODULE_1__),_taquito_taquito__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(1134),ethers__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(82169),ethers__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(38197),ethers__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(91023);const tezosSdk=new _taquito_taquito__WEBPACK_IMPORTED_MODULE_2__.TezosToolkit("https://rpc.ghostnet.teztnets.xyz"),stateAggregator=new ibcf_sdk__WEBPACK_IMPORTED_MODULE_1__.Tezos.Contracts.StateAggregator.Contract(tezosSdk,"KT1Aqdz8opKsfADxmF2vf6NMoYwgamL5R4KT"),ETHEREUM_RPC="https://goerli.infura.io/v3/75829a5785c844bc9c9e6e891130ee6f",provider=new ethers__WEBPACK_IMPORTED_MODULE_3__.r(ETHEREUM_RPC),proofGenerator=new ibcf_sdk__WEBPACK_IMPORTED_MODULE_1__.Ethereum.ProofGenerator(provider),destinationRegistryIndex="05".padStart(64,"0"),amountRegistryIndex="06".padStart(64,"0"),destinationSlot=ethers__WEBPACK_IMPORTED_MODULE_4__.w("0x01"+destinationRegistryIndex),amountSlot=ethers__WEBPACK_IMPORTED_MODULE_4__.w("0x01"+amountRegistryIndex);function replaceAll(e,t,n){return e.split(t).join(n)}const removeImports=e=>e.split("\n").map((e=>{let t=!0;e.trim().startsWith("import")&&(t=!1);return t?e:void 0})).filter((e=>!!e)).join("\n"),runCode=(rawCode,setOutput)=>{let code=rawCode;const coinlib={};let output="";const appendOutput=e=>{output+="\n"+e,setOutput(output.trim())},myLog=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];console.log("CODE_RUNNER:",...t),appendOutput(t.map((e=>"object"==typeof e?JSON.stringify(e,null,2):e)).join(" "))},lib={IbcfSdk:ibcf_sdk__WEBPACK_IMPORTED_MODULE_1__,TezosToolkit:_taquito_taquito__WEBPACK_IMPORTED_MODULE_2__.TezosToolkit,ethers:ethers__WEBPACK_IMPORTED_MODULE_5__};let runnable;return console.log(code),code=replaceAll(code,"console.log","progress"),code=removeImports(code),console.log(code),code=typescript__WEBPACK_IMPORTED_MODULE_0__.transpile(`({\n        run: async (prelude: any, progress: any): string => {\n          Object.keys(prelude).forEach(key => {\n            window[key] = prelude[key]\n          })\n          return (async () => {\n            ${code};\n            if (typeof result !== 'undefined') {\n              return result\n            }\n          })()\n        })`),console.log(code),new Promise((resolve=>{try{runnable=eval(code),runnable.run(lib,myLog).then((e=>{e&&appendOutput("Returned:\n"+JSON.stringify(e,null,2)),resolve(e)})).catch((e=>{console.warn(e),appendOutput(JSON.stringify(e,null,2)),resolve(e)}))}catch(e){appendOutput(e),console.error(e),resolve(e)}}))}},56387:(e,t,n)=>{"use strict";n.r(t),n.d(t,{assets:()=>h,contentTitle:()=>k,default:()=>D,frontMatter:()=>T,metadata:()=>b,toc:()=>y});var o=n(87462),r=n(67294),s=n(3905);const a="browserWindow_vOie",i="browserWindowBody_mRjT";const l=function(e){let{children:t,minHeight:n=""}=e;return r.createElement("div",{className:a,style:{minHeight:n}},r.createElement("div",{className:i},t))};var _=n(92949);const c=[],d=(0,r.lazy)((()=>Promise.all([n.e(532),n.e(302)]).then(n.bind(n,2302))));const u=function(e){let t;const{colorMode:n}=(0,_.I)();return r.createElement(r.Suspense,{fallback:r.createElement("div",null,"Loading")},r.createElement(d,(0,o.Z)({},e,{editorWillMount:function(n){t=n,n.editor.defineTheme("vs-dark",{base:"vs-dark",inherit:!0,rules:[{background:"121212"}],colors:{"editor.background":"#121212"}}),n.languages.typescript.typescriptDefaults.setCompilerOptions({target:n.languages.typescript.ScriptTarget.ES2017,allowNonTsExtensions:!0,moduleResolution:n.languages.typescript.ModuleResolutionKind.NodeJs,module:n.languages.typescript.ModuleKind.ESNext,typeRoots:["node_modules/@types"]}),c.forEach((e=>{const t=`file:///node_modules/${e.name}`;n.languages.typescript.typescriptDefaults.addExtraLib(e.dts,t)})),e.editorWillMount&&e.editorWillMount(n)},editorWillUnmount:()=>{},editorDidMount:function(n){n.setModel(t.editor.createModel(e.value,"typescript",t.Uri.parse(`file:///main-${Math.random()}.ts`)))},theme:"dark"===n?"vs-dark":"vs-light"})))},p=()=>{const{colorMode:e}=(0,_.I)();return r.createElement("svg",{style:{width:"24px"},className:"margin-right--sm",width:"38",height:"38",viewBox:"0 0 38 38",xmlns:"http://www.w3.org/2000/svg",stroke:"dark"===e?"#fff":"#3880ff"},r.createElement("g",{fill:"none",fillRule:"evenodd"},r.createElement("g",{transform:"translate(1 1)",strokeWidth:"2"},r.createElement("circle",{strokeOpacity:".5",cx:"18",cy:"18",r:"18"}),r.createElement("path",{d:"M36 18c0-9.94-8.06-18-18-18"},r.createElement("animateTransform",{attributeName:"transform",type:"rotate",from:"0 18 18",to:"360 18 18",dur:"1s",repeatCount:"indefinite"})))))};var E=n(38996);let m;!function(e){e[e.INIT=0]="INIT",e[e.STARTED=1]="STARTED",e[e.ENDED=2]="ENDED"}(m||(m={}));const g=e=>{let{code:t}=e;const[n,s]=(0,r.useState)(t.props.children.props.children),[a,i]=(0,r.useState)(m.INIT),[_,c]=(0,r.useState)(""),[d,g]=(0,r.useState)(!0),f=async()=>{c(""),i(m.INIT)},T={width:800,height:18*(1+n.split("\n").length)};return r.createElement(r.Fragment,null,d?t:r.createElement(u,(0,o.Z)({},T,{language:"typescript",value:n,onChange:e=>{s(e)},options:{scrollBeyondLastLine:!1,minimap:{enabled:!1},wordWrap:"on"}})),r.createElement(l,null,r.createElement("button",{className:"button button--primary margin-right--xs",onClick:()=>{(async()=>{a!==m.STARTED&&(await f(),i(m.STARTED),setTimeout((async()=>{await(0,E._)(n,c),i(m.ENDED)}),10))})()}},"Run Code"),r.createElement("button",{className:"button button--secondary margin-right--xs",onClick:()=>{(async()=>{g(!d)})()}},d?"Edit Code":"Show Example"),r.createElement("button",{className:"button button--secondary",onClick:()=>{f()}},"Clear Output"),a!==m.INIT?r.createElement(r.Fragment,null,r.createElement("h4",{className:"margin-vert--md"},"Output"),r.createElement("pre",null,r.createElement("span",{className:"d-align-items--center"},a===m.STARTED?r.createElement(r.Fragment,null,r.createElement(p,null)):"",_||a===m.ENDED?_:"Waiting for output..."))):""))},f=e=>r.createElement(g,{code:e.children}),T={title:"Bridge",slug:"/examples/bridge",hide_title:!0},k=void 0,b={unversionedId:"examples/bridge",id:"examples/bridge",title:"Bridge",description:"Generate proof-of-inclusion (Tezos EVM)",source:"@site/docs/examples/bridge.mdx",sourceDirName:"examples",slug:"/examples/bridge",permalink:"/ibcf-docs/examples/bridge",draft:!1,editUrl:"https://github.com/airgap-it/ibcf-docs/docs/examples/bridge.mdx",tags:[],version:"current",frontMatter:{title:"Bridge",slug:"/examples/bridge",hide_title:!0},sidebar:"docs",previous:{title:"Proof Validator",permalink:"/ibcf-docs/relay-contracts/evm/validator"}},h={},y=[{value:"Generate proof-of-inclusion (Tezos \u27a1\ufe0f EVM)",id:"generate-proof-of-inclusion-tezos-\ufe0f-evm",level:2},{value:"Generate proof-of-inclusion (EVM \u27a1\ufe0f Tezos)",id:"generate-proof-of-inclusion-evm-\ufe0f-tezos",level:2}],M={toc:y};function D(e){let{components:t,...n}=e;return(0,s.kt)("wrapper",(0,o.Z)({},M,n,{components:t,mdxType:"MDXLayout"}),(0,s.kt)("h2",{id:"generate-proof-of-inclusion-tezos-\ufe0f-evm"},"Generate proof-of-inclusion (Tezos \u27a1\ufe0f EVM)"),(0,s.kt)(f,{mdxType:"RunnableCode"},(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-ts"},"// import * as IbcfSdk from 'ibcf-sdk';\n// import { TezosToolkit } from \"@taquito/taquito\";\n\nconst tezosSdk = new TezosToolkit('https://rpc.ghostnet.teztnets.xyz');\nconst stateAggregator = new IbcfSdk.Tezos.Contracts.StateAggregator.Contract(tezosSdk, \"KT1Aqdz8opKsfADxmF2vf6NMoYwgamL5R4KT\");\n\nconst STATE_ORIGIN = 'KT1AfcN12T2d43XtJLbahmpDr13xda4Zedxx';\nconst STATE_KEY = '0x01';\nconst SNAPSHOT_LEVEL = '1805119';\n\nstateAggregator.getProof(\n    STATE_ORIGIN,               // Origin\n    STATE_KEY,                  // State key\n    SNAPSHOT_LEVEL              // Block level where the snapshot was taken\n).then(console.log)\n"))),(0,s.kt)("h2",{id:"generate-proof-of-inclusion-evm-\ufe0f-tezos"},"Generate proof-of-inclusion (EVM \u27a1\ufe0f Tezos)"),(0,s.kt)(f,{mdxType:"RunnableCode"},(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-ts"},"// import * as IbcfSdk from 'ibcf-sdk';\n// import { ethers } from 'ethers';\n\nconst ETHEREUM_RPC=\"https://goerli.infura.io/v3/75829a5785c844bc9c9e6e891130ee6f\";\nconst ETHEREUM_DAPP = '0x10758d99D642428fd6A8B62A149aB2d1ade20C24';\nconst BLOCK_NUMBER = 8332856;\n\nconst provider = new ethers.providers.JsonRpcProvider(ETHEREUM_RPC);\n\nconst proofGenerator = new IbcfSdk.Ethereum.ProofGenerator(provider);\n\n// EVM storage slot indexes (Each slot index is identified by 32 bytes)\n// - slot 0 ...\n// - slot 1 ...\n// - slot 2 ...\n// - slot 3 ...\n// - slot 4 ...\n// - slot 5 -> mapping(uint => bytes) destination_registry;\n// - slot 6 -> mapping(uint => uint) amount_registry;\nconst destinationRegistryIndex = '5'.padStart(64, '0');\nconst amountRegistryIndex = '6'.padStart(64, '0');\n\n// Key RLP encoded\nconst keyRLP = \"0x01\";\n\n// Storage slots\n// - Each mapping slot is the result of keccak256(<rlp_key> +  <slot_index>)\nconst destinationSlot = ethers.utils.keccak256(keyRLP + destinationRegistryIndex);\nconst amountSlot = ethers.utils.keccak256(keyRLP + amountRegistryIndex);\n\nproofGenerator.generateStorageProof(\n    ETHEREUM_DAPP,\n    [destinationSlot, amountSlot],\n    BLOCK_NUMBER\n).then(console.log)\n"))))}D.isMDXComponent=!0},13411:e=>{function t(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=13411,e.exports=t},35883:()=>{},46601:()=>{},89214:()=>{},85568:()=>{},52361:()=>{},94616:()=>{},62183:()=>{},13024:()=>{},62715:()=>{},13611:()=>{},28353:()=>{},1210:()=>{},43454:()=>{}}]);